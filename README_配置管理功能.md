# 配置管理功能说明

## 概述
在图片模型训练系统的设置界面中，我们新增了完整的配置管理功能，包括：
1. **缺陷类别管理**：保存和加载缺陷类别列表
2. **完整配置管理**：保存和加载所有应用设置

这些功能使用户能够方便地管理、备份、分享和切换不同的配置方案。

## 功能详述

### 1. 缺陷类别管理功能

#### 位置
设置界面 → 常规设置 → 默认缺陷类别

#### 功能按钮
- **保存到文件**：将当前缺陷类别列表保存到文件
- **从文件加载**：从文件加载缺陷类别列表

#### 支持格式
- **JSON格式**：结构化数据，包含类别列表和元数据
- **文本格式**：简单文本，每行一个类别

### 2. 完整配置管理功能

#### 位置
设置界面底部按钮区域

#### 功能按钮
- **保存设置**：保存到系统默认配置文件（config.json）
- **保存配置到文件**：将完整配置导出到指定文件
- **从文件加载配置**：从文件加载完整配置

#### 包含的配置项
- 默认源文件夹
- 默认输出文件夹
- 默认模型文件
- 默认类别信息文件
- 默认模型评估文件夹
- 默认模型保存文件夹
- 默认TensorBoard日志文件夹
- 默认数据集评估文件夹
- 默认训练参数保存文件夹
- 默认缺陷类别列表

## 配置文件格式

### 完整配置文件格式示例
```json
{
    "config": {
        "default_source_folder": "E:\\EPIC_SLM\\TEST\\SOURCE2",
        "default_output_folder": "E:\\EPIC_SLM\\TEST\\OUTPUT2",
        "default_model_file": "models\\best_model.pth",
        "default_class_info_file": "config\\class_info.json",
        "default_model_eval_dir": "evaluations\\models",
        "default_model_save_dir": "saved_models",
        "default_tensorboard_log_dir": "logs\\tensorboard",
        "default_dataset_dir": "datasets\\evaluation",
        "default_param_save_dir": "config\\training_params",
        "default_classes": [
            "Missing_hole",
            "Mouse_bite",
            "Open_circuit",
            "Short",
            "Spur",
            "Spurious_copper"
        ]
    },
    "metadata": {
        "created_by": "图片模型训练系统",
        "version": "1.0",
        "description": "应用设置配置文件",
        "export_time": "2024-01-01 12:00:00"
    }
}
```

### 缺陷类别文件格式示例

#### JSON格式
```json
{
    "defect_classes": [
        "Missing_hole",
        "Mouse_bite",
        "Open_circuit"
    ],
    "total_count": 3,
    "created_by": "图片模型训练系统",
    "version": "1.0"
}
```

#### 文本格式
```
缺陷类别列表
====================
1. Missing_hole
2. Mouse_bite
3. Open_circuit

总计: 3 个类别
```

## 使用场景

### 1. 项目切换
- 为不同项目保存专用配置
- 快速切换项目设置
- 避免重复配置工作

### 2. 团队协作
- 团队成员共享标准配置
- 确保环境一致性
- 新成员快速上手

### 3. 备份恢复
- 定期备份重要配置
- 系统重装后快速恢复
- 防止配置丢失

### 4. 实验管理
- 保存不同实验的配置
- 对比不同配置效果
- 回滚到之前的配置

## 操作指南

### 保存缺陷类别到文件
1. 在设置界面配置好缺陷类别
2. 点击"保存到文件"按钮
3. 选择保存位置和格式（JSON或TXT）
4. 确认保存

### 从文件加载缺陷类别
1. 点击"从文件加载"按钮
2. 选择要加载的文件
3. 查看预览信息
4. 选择加载模式（替换或追加）
5. 确认加载

### 保存完整配置到文件
1. 配置好所有设置项
2. 点击"保存配置到文件"按钮
3. 选择保存位置
4. 确认保存

### 从文件加载完整配置
1. 点击"从文件加载配置"按钮
2. 选择配置文件
3. 查看配置预览
4. 确认加载（会覆盖当前设置）
5. 点击"保存设置"保存到系统

## 安全特性

### 数据保护
- 加载前显示详细预览
- 明确提示覆盖风险
- 支持取消操作

### 错误处理
- 文件格式验证
- 详细错误信息
- 优雅的错误恢复

### 兼容性
- 支持多种文件格式
- 向后兼容旧版本
- 自动格式识别

## 注意事项

1. **文件编码**：建议使用UTF-8编码
2. **路径格式**：支持Windows和Unix路径格式
3. **权限要求**：确保对目标文件夹有写入权限
4. **备份建议**：重要配置建议定期备份
5. **版本管理**：可以为配置文件添加版本标识

## 示例文件

项目中提供了以下示例文件：
- `settings_config_example.json`：完整配置示例
- `defect_classes_example.json`：缺陷类别JSON示例
- `defect_classes_example.txt`：缺陷类别文本示例

这些文件可以用于测试功能或作为创建自定义配置的模板。

## 技术实现

### 核心功能
- 基于PyQt5的文件对话框
- JSON格式的配置序列化
- 多格式文件支持
- 用户友好的交互界面

### 数据验证
- JSON格式验证
- 配置项完整性检查
- 类型安全保证
- 异常处理机制 